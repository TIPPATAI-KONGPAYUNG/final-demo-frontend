FROM node:20-alpine

# ติดตั้ง build tools
RUN apk add --no-cache python3 make g++

WORKDIR /app

# คัดลอก package.json ก่อน
COPY package*.json ./

# ติดตั้ง dependencies (force rebuild)
RUN npm install --force

# คัดลอก source code ทั้งหมด
COPY . .

# เปิด port ของ Vite
EXPOSE 5173

# รัน dev server ผ่าน npm script
CMD ["npm", "run", "dev", "--", "--host"]
